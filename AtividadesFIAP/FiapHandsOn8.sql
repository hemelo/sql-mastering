-- SCRIPT PARA CRIAÇÃO DO BANCO DE DADOS
-- DO ESTUDO DE CASO SIP
-- COMANDOS PARA EXCLUIR AS TABELAS
DROP TABLE t_sip_departamento CASCADE CONSTRAINTS;
DROP TABLE t_sip_dependente CASCADE CONSTRAINTS;
DROP TABLE t_sip_funcionario CASCADE CONSTRAINTS;
DROP TABLE t_sip_implantacao CASCADE CONSTRAINTS;
DROP TABLE t_sip_projeto CASCADE CONSTRAINTS;

-- COMANDOS PARA CRIAR AS TABELAS
-- E ADICIONAR CONSTRAINTS: PRIMARY KEY, CHECK E UNIQUE
CREATE TABLE t_sip_departamento
(
    cd_depto NUMBER(3)      NOT NULL,
    nm_depto VARCHAR2(30)   NOT NULL,
    sg_depto CHAR(3) NOT NULL
);

COMMENT
ON COLUMN t_sip_departamento.cd_depto IS
    'Um departamento é identificado por um código numérico de três dígitos.';

ALTER TABLE t_sip_departamento
    ADD CONSTRAINT pk_sip_departamento
        PRIMARY KEY (cd_depto);

ALTER TABLE t_sip_departamento
    ADD CONSTRAINT un_sip_depto_nome
        UNIQUE (nm_depto);

ALTER TABLE t_sip_departamento
    ADD CONSTRAINT un_sip_depto_sigla
        UNIQUE (sg_depto);

CREATE TABLE t_sip_dependente
(
    nr_matricula  NUMBER(5)     NOT NULL,
    cd_dependente NUMBER(2)     NOT NULL,
    nm_dependente VARCHAR2(50)  NOT NULL,
    dt_nascimento DATE NOT NULL
);

ALTER TABLE t_sip_dependente
    ADD CONSTRAINT pk_sip_dependente
        PRIMARY KEY (nr_matricula, cd_dependente);

CREATE TABLE t_sip_funcionario
(
    nr_matricula      NUMBER(5)     NOT NULL,
    cd_depto          NUMBER(3)     NOT NULL,
    nm_funcionario    VARCHAR2(50)  NOT NULL,
    dt_nascimento     DATE NOT NULL,
    dt_admissao       DATE NOT NULL,
    ds_endereco       VARCHAR2(100) NOT NULL,
    vl_salario_mensal NUMBER(7, 2) NOT NULL
);

ALTER TABLE t_sip_funcionario
    ADD CONSTRAINT ck_sip_func_salario
        CHECK ( vl_salario_mensal >= 1212 );

ALTER TABLE t_sip_funcionario
    ADD CONSTRAINT pk_sip_funcionario
        PRIMARY KEY (nr_matricula);

CREATE TABLE t_sip_implantacao
(
    cd_projeto     NUMBER(5) NOT NULL,
    cd_implantacao NUMBER(3) NOT NULL,
    nr_matricula   NUMBER(5) NOT NULL,
    dt_entrada     DATE NOT NULL,
    dt_saida       DATE NULL
);

ALTER TABLE t_sip_implantacao
    ADD CONSTRAINT ck_sip_implant_data
        CHECK ( dt_saida > dt_entrada );

ALTER TABLE t_sip_implantacao
    ADD CONSTRAINT pk_sip_implantacao
        PRIMARY KEY (cd_projeto, cd_implantacao);

CREATE TABLE t_sip_projeto
(
    cd_projeto NUMBER(5)    NOT NULL,
    nm_projeto VARCHAR2(40) NOT NULL,
    dt_inicio  DATE NOT NULL,
    dt_termino DATE
);

-- ADICIONAR CONSTRAINT FOREIGN KEY
ALTER TABLE t_sip_projeto
    ADD CONSTRAINT ck_sip_projeto_data
        CHECK ( dt_termino > dt_inicio );

ALTER TABLE t_sip_projeto
    ADD CONSTRAINT pk_sip_projeto
        PRIMARY KEY (cd_projeto);

ALTER TABLE t_sip_projeto
    ADD CONSTRAINT un_sip_projeto_nome
        UNIQUE (nm_projeto);

ALTER TABLE t_sip_dependente
    ADD CONSTRAINT fk_sip_dependente_func
        FOREIGN KEY (nr_matricula)
            REFERENCES t_sip_funcionario (nr_matricula);

ALTER TABLE t_sip_funcionario
    ADD CONSTRAINT fk_sip_func_depto
        FOREIGN KEY (cd_depto)
            REFERENCES t_sip_departamento (cd_depto);

ALTER TABLE t_sip_implantacao
    ADD CONSTRAINT fk_sip_implant_func
        FOREIGN KEY (nr_matricula)
            REFERENCES t_sip_funcionario (nr_matricula);

ALTER TABLE t_sip_implantacao
    ADD CONSTRAINT fk_sip_implant_projeto
        FOREIGN KEY (cd_projeto)
            REFERENCES t_sip_projeto (cd_projeto);

-- SCRIPT PARA POPULAR O BD IMPLANTACAO DE PROJETOS

-- ELIMINA O CONTEUDO DAS TABELAS
/*
DELETE FROM T_SIP_IMPLANTACAO;
DELETE FROM T_SIP_PROJETO;
DELETE FROM T_SIP_DEPENDENTE;
DELETE FROM T_SIP_FUNCIONARIO;
DELETE FROM T_SIP_DEPARTAMENTO;
*/

-- POPULAR A TABELA DEPTO COM 5 DEPARTAMENTOS
INSERT INTO T_SIP_DEPARTAMENTO
VALUES (1, 'FINANCEIRO', 'FIN');
INSERT INTO T_SIP_DEPARTAMENTO
VALUES (2, 'TECNOLOGIA DA INFORMAÇÃO', 'TIN');
INSERT INTO T_SIP_DEPARTAMENTO
VALUES (3, 'CONTAS A PAGAR', 'CPG');
INSERT INTO T_SIP_DEPARTAMENTO
VALUES (4, 'FATURAMENTO', 'FAT');
INSERT INTO T_SIP_DEPARTAMENTO
VALUES (5, 'RECURSOS HUMANOS', 'RHU');

-- POPULAR A TABELA FUNCIONARIO COM 3 FUNCIONARIOS PARA CADA DEPTO
-- DEPTO = 1
INSERT INTO T_SIP_FUNCIONARIO
VALUES (12345, 1, 'JOAO DA SILVA', TO_DATE('10/05/1985', 'DD/MM/YYYY'),
        TO_DATE('15/09/2012', 'DD/MM/YYYY'), 'RUA X, 49', 5684.66);

INSERT INTO T_SIP_FUNCIONARIO
VALUES (12346, 1, 'MANUEL DA SILVA', TO_DATE('05/10/1998', 'DD/MM/YYYY'),
        TO_DATE('10/11/2015', 'DD/MM/YYYY'), 'RUA X, 31', 3542.11);

INSERT INTO T_SIP_FUNCIONARIO
VALUES (12347, 1, 'JANDIRA DA SILVA', TO_DATE('10/12/2000', 'DD/MM/YYYY'),
        TO_DATE('15/09/2018', 'DD/MM/YYYY'), 'RUA X, 25', 1875.96);

-- DEPTO = 2
INSERT INTO T_SIP_FUNCIONARIO
VALUES (12348, 2, 'KATIA REGINA SOUZA', TO_DATE('15/01/1995', 'DD/MM/YYYY'),
        TO_DATE('03/10/2015', 'DD/MM/YYYY'), 'RUA Y, 49', 3894.63);

INSERT INTO T_SIP_FUNCIONARIO
VALUES (12349, 2, 'MARIA DAS DORES SOUZA', TO_DATE('18/08/1983', 'DD/MM/YYYY'),
        TO_DATE('23/10/2017', 'DD/MM/YYYY'), 'RUA Y, 35', 1542.55);

INSERT INTO T_SIP_FUNCIONARIO
VALUES (12350, 2, 'ALFREDO DE SOUZA', TO_DATE('04/05/1999', 'DD/MM/YYYY'),
        TO_DATE('05/06/2014', 'DD/MM/YYYY'), 'RUA Y, 27', 5874.52);

-- DEPTO = 3
INSERT INTO T_SIP_FUNCIONARIO
VALUES (12351, 3, 'GISELE DE JESUS', TO_DATE('15/04/1999', 'DD/MM/YYYY'),
        TO_DATE('20/03/2017', 'DD/MM/YYYY'), 'RUA Z, 49', 1360.66);

INSERT INTO T_SIP_FUNCIONARIO
VALUES (12352, 3, 'RAFAEL DE JESUS', TO_DATE('10/08/1998', 'DD/MM/YYYY'),
        TO_DATE('10/08/2012', 'DD/MM/YYYY'), 'RUA Z, 55', 2563.44);

INSERT INTO T_SIP_FUNCIONARIO
VALUES (12353, 3, 'ROSANA DE JESUS', TO_DATE('14/03/1987', 'DD/MM/YYYY'),
        TO_DATE('15/08/2019', 'DD/MM/YYYY'), 'RUA Z, 79', 4879.55);

-- DEPTO = 4
INSERT INTO T_SIP_FUNCIONARIO
VALUES (12354, 4, 'JOSEFINA DE ALMEIDA', TO_DATE('16/10/1997', 'DD/MM/YYYY'),
        TO_DATE('25/03/2013', 'DD/MM/YYYY'), 'RUA Y, 33', 4561.88);

INSERT INTO T_SIP_FUNCIONARIO
VALUES (12355, 4, 'LUCIANA DE ALMEIDA', TO_DATE('10/02/1984', 'DD/MM/YYYY'),
        TO_DATE('28/09/2011', 'DD/MM/YYYY'), 'RUA Y, 44', 2345.52);

INSERT INTO T_SIP_FUNCIONARIO
VALUES (12356, 4, 'THIAGO DE ALMEIDA', TO_DATE('10/03/1998', 'DD/MM/YYYY'),
        TO_DATE('24/10/2018', 'DD/MM/YYYY'), 'RUA Y, 55', 1254.22);

-- DEPTO = 5
INSERT INTO T_SIP_FUNCIONARIO
VALUES (12357, 5, 'LARISSSA DE CAMARGO', TO_DATE('14/02/1997', 'DD/MM/YYYY'),
        TO_DATE('04/08/2015', 'DD/MM/YYYY'), 'RUA V, 22', 1245.55);

INSERT INTO T_SIP_FUNCIONARIO
VALUES (12358, 5, 'ANTONIO DE CAMARGO', TO_DATE('25/01/1985', 'DD/MM/YYYY'),
        TO_DATE('12/08/2016', 'DD/MM/YYYY'), 'RUA V, 44', 2451.33);

INSERT INTO T_SIP_FUNCIONARIO
VALUES (12359, 5, 'JOSE DE CAMARGO', TO_DATE('23/10/1998', 'DD/MM/YYYY'),
        TO_DATE('20/04/2017', 'DD/MM/YYYY'), 'RUA V, 88', 6541.22);

-- POPULAR A TABELA DEPENDENTE. ESCOLHER 3 FUNCIONARIOS E CADASTRAR 3 DEPENDENTES
-- PARA CADA FUNCIONARIO ESCOLHIDO
-- FUNCIONARIO = 12345
INSERT INTO T_SIP_DEPENDENTE
VALUES (12345, 1, 'JOANINHA', TO_DATE('12/10/2010', 'DD/MM/YYYY'));
INSERT INTO T_SIP_DEPENDENTE
VALUES (12345, 2, 'JULINHA', TO_DATE('15/10/2012', 'DD/MM/YYYY'));
INSERT INTO T_SIP_DEPENDENTE
VALUES (12345, 3, 'TONINHO', TO_DATE('22/10/2014', 'DD/MM/YYYY'));

-- FUNCIONARIO = 12356
INSERT INTO T_SIP_DEPENDENTE
VALUES (12356, 1, 'JUNINHO', TO_DATE('02/10/2011', 'DD/MM/YYYY'));
INSERT INTO T_SIP_DEPENDENTE
VALUES (12356, 2, 'ZEZINHO', TO_DATE('15/10/2013', 'DD/MM/YYYY'));
INSERT INTO T_SIP_DEPENDENTE
VALUES (12356, 3, 'MARCELINHO', TO_DATE('17/10/2015', 'DD/MM/YYYY'));

-- FUNCIONARIO = 12359
INSERT INTO T_SIP_DEPENDENTE
VALUES (12359, 1, 'MARIAZINHA', TO_DATE('11/06/2014', 'DD/MM/YYYY'));
INSERT INTO T_SIP_DEPENDENTE
VALUES (12359, 2, 'LUIZINHA', TO_DATE('21/06/2016', 'DD/MM/YYYY'));
INSERT INTO T_SIP_DEPENDENTE
VALUES (12359, 3, 'CARMINHA', TO_DATE('18/06/2018', 'DD/MM/YYYY'));

-- POPULAR A TABELA PROJETO COM 5 PROJETOS
-- 3 PROJETOS SEM A DATA TÉRMINO
INSERT INTO T_SIP_PROJETO
VALUES (10001, 'PROJETO 1', TO_DATE('11/10/2016', 'DD/MM/YYYY'), NULL);
INSERT INTO T_SIP_PROJETO
VALUES (10002, 'PROJETO 2', TO_DATE('25/10/2013', 'DD/MM/YYYY'), TO_DATE('15/04/2015', 'DD/MM/YYYY'));
INSERT INTO T_SIP_PROJETO
VALUES (10003, 'PROJETO 3', TO_DATE('28/04/2012', 'DD/MM/YYYY'), NULL);
INSERT INTO T_SIP_PROJETO
VALUES (10004, 'PROJETO 4', TO_DATE('25/03/2017', 'DD/MM/YYYY'), NULL);
INSERT INTO T_SIP_PROJETO
VALUES (10005, 'PROJETO 5', TO_DATE('28/09/2014', 'DD/MM/YYYY'), TO_DATE('15/09/2018', 'DD/MM/YYYY'));

-- POPULAR A TABELA IMPLANTACAO
-- PROJETO 1
INSERT INTO T_SIP_IMPLANTACAO
VALUES (10001, 1, 12345, TO_DATE('11/10/2016', 'DD/MM/YYYY'), TO_DATE('15/09/2017', 'DD/MM/YYYY'));
INSERT INTO T_SIP_IMPLANTACAO
VALUES (10001, 2, 12346, TO_DATE('11/10/2016', 'DD/MM/YYYY'), NULL);
INSERT INTO T_SIP_IMPLANTACAO
VALUES (10001, 3, 12348, TO_DATE('11/10/2016', 'DD/MM/YYYY'), TO_DATE('25/06/2018', 'DD/MM/YYYY'));
-- PROJETO 2
INSERT INTO T_SIP_IMPLANTACAO
VALUES (10002, 1, 12345, TO_DATE('25/10/2013', 'DD/MM/YYYY'), TO_DATE('15/04/2014', 'DD/MM/YYYY'));
INSERT INTO T_SIP_IMPLANTACAO
VALUES (10002, 2, 12352, TO_DATE('25/10/2013', 'DD/MM/YYYY'), TO_DATE('25/07/2014', 'DD/MM/YYYY'));
INSERT INTO T_SIP_IMPLANTACAO
VALUES (10002, 3, 12355, TO_DATE('25/10/2013', 'DD/MM/YYYY'), TO_DATE('15/04/2015', 'DD/MM/YYYY'));
-- PROJETO 3
INSERT INTO T_SIP_IMPLANTACAO
VALUES (10003, 1, 12354, TO_DATE('28/04/2013', 'DD/MM/YYYY'), NULL);
INSERT INTO T_SIP_IMPLANTACAO
VALUES (10003, 2, 12355, TO_DATE('28/04/2013', 'DD/MM/YYYY'), NULL);
INSERT INTO T_SIP_IMPLANTACAO
VALUES (10003, 3, 12345, TO_DATE('28/04/2013', 'DD/MM/YYYY'), NULL);
-- PROJETO 4
INSERT INTO T_SIP_IMPLANTACAO
VALUES (10004, 1, 12357, TO_DATE('25/03/2017', 'DD/MM/YYYY'), NULL);
INSERT INTO T_SIP_IMPLANTACAO
VALUES (10004, 2, 12358, TO_DATE('25/03/2017', 'DD/MM/YYYY'), NULL);
INSERT INTO T_SIP_IMPLANTACAO
VALUES (10004, 3, 12354, TO_DATE('25/03/2017', 'DD/MM/YYYY'), TO_DATE('15/08/2018', 'DD/MM/YYYY'));
-- PROJETO 5
INSERT INTO T_SIP_IMPLANTACAO
VALUES (10005, 1, 12345, TO_DATE('28/09/2014', 'DD/MM/YYYY'), TO_DATE('15/09/2018', 'DD/MM/YYYY'));
INSERT INTO T_SIP_IMPLANTACAO
VALUES (10005, 2, 12350, TO_DATE('28/09/2014', 'DD/MM/YYYY'), TO_DATE('15/09/2018', 'DD/MM/YYYY'));
INSERT INTO T_SIP_IMPLANTACAO
VALUES (10005, 3, 12354, TO_DATE('28/09/2014', 'DD/MM/YYYY'), TO_DATE('15/09/2018', 'DD/MM/YYYY'));

-- CONSULTAR TABELAS
SELECT *
FROM T_SIP_DEPARTAMENTO;
SELECT *
FROM T_SIP_FUNCIONARIO;
SELECT *
FROM T_SIP_DEPENDENTE;
SELECT *
FROM T_SIP_PROJETO;
SELECT *
FROM T_SIP_IMPLANTACAO;

--EFETIVAR AS TRANSAÇÕES PENDENTES
COMMIT;

-- EXEMPLO – SUBCONSULTA DE UMA ÚNICA LINHA,
-- COM FUNÇÕES DE GRUPO
SELECT F.NM_FUNCIONARIO,
       F.VL_SALARIO_MENSAL
FROM T_SIP_FUNCIONARIO F
WHERE F.VL_SALARIO > (SELECT AVG(F.VL_SALARIO_MENSAL)
                      FROM T_SIP_FUNCIONARIO F);

-- EXEMPLO – SUBCONSULTA DE UMA ÚNICA LINHA,
-- COM AGRUPAMENTO, FUNÇÕES DE GRUPO E HAVING
SELECT CD_DEPTO,
       MIN(VL_SALARIO_MENSAL)
FROM T_SIP_FUNCIONARIO
GROUP BY CD_DEPTO
HAVING MIN(VL_SALARIO_MENSAL) > (SELECT MIN(VL_SALARIO_MENSAL)
                                 FROM T_SIP_FUNCIONARIO
                                 WHERE CD_DEPTO = 3);

-- EXEMPLO – SUBCONSULTA DE UMA ÚNICA LINHA,
-- COM AGRUPAMENTO, FUNÇÕES DE GRUPO E HAVING
SELECT CD_DEPTO,
       MIN(VL_SALARIO_MENSAL)
FROM T_SIP_FUNCIONARIO
GROUP BY CD_DEPTO
HAVING MIN(VL_SALARIO_MENSAL) > (SELECT MIN(VL_SALARIO_MENSAL)
                                 FROM T_SIP_FUNCIONARIO
                                 WHERE CD_DEPTO = 3);

-- EXEMPLO – SUBCONSULTA PARA CRIAR TABELAS
CREATE TABLE T_TESTE_AULA_ON AS
SELECT *
FROM T_SIP_IMPLANTACAO;

-- EXEMPLO – SUBCONSULTA COM VÁRIAS LINHAS,
-- COM OPERADOR IN
SELECT CD_IMPLANTACAO,
       CD_PROJETO,
       NR_MATRICULA "FUNCIONARIO"
FROM T_SIP_IMPLANTACAO
WHERE CD_PROJETO IN
      (SELECT CD_PROJETO
       FROM T_SIP_PROJETO
       WHERE TO_CHAR(DT_INICIO, 'MM/YYYY') IN ('04/2012', '10/2013'));

-- EXEMPLO – SUBCONSULTA COM VÁRIAS LINHAS,
-- COM OPERADOR NOT IN
SELECT CD_IMPLANTACAO,
       CD_PROJETO,
       NR_MATRICULA "FUNCIONARIO"
FROM T_SIP_IMPLANTACAO
WHERE CD_PROJETO NOT IN
      (SELECT CD_PROJETO
       FROM T_SIP_PROJETO
       WHERE TO_CHAR(DT_INICIO, 'MM/YYYY') IN ('04/2012', '10/2013'));

-- EXEMPLO – SUBCONSULTA COM VÁRIAS LINHAS,
-- COM OPERADOR ANY
SELECT NR_MATRICULA,
       NM_FUNCIONARIO,
       VL_SALARIO_MENSAL
FROM T_SIP_FUNCIONARIO
WHERE VL_SALARIO_MENSAL < ANY
      (SELECT AVG(VL_SALARIO_MENSAL)
       FROM T_SIP_FUNCIONARIO
       GROUP BY CD_DEPTO);

-- EXEMPLO – SUBCONSULTA COM VÁRIAS LINHAS,
-- COM OPERADOR ALL
SELECT NR_MATRICULA,
       NM_FUNCIONARIO,
       VL_SALARIO_MENSAL
FROM T_SIP_FUNCIONARIO
WHERE VL_SALARIO_MENSAL > ALL
      (SELECT AVG(VL_SALARIO_MENSAL)
       FROM T_SIP_FUNCIONARIO
       GROUP BY CD_DEPTO);

-- EXEMPLO – SUBCONSULTA CORRELACIONADA,
-- COM EXISTS
SELECT F.NR_MATRICULA,
       F.NM_FUNCIONARIO
FROM T_SIP_FUNCIONARIO F
WHERE EXISTS
          (SELECT I.NR_MATRICULA
           FROM T_SIP_IMPLANTACAO I
           WHERE F.NR_MATRICULA = I.NR_MATRICULA);

-- EXEMPLO – SUBCONSULTA CORRELACIONADA,
-- COM NOT EXISTS
SELECT F.NR_MATRICULA,
       F.NM_FUNCIONARIO
FROM T_SIP_FUNCIONARIO F
WHERE NOT EXISTS
          (SELECT I.NR_MATRICULA
           FROM T_SIP_IMPLANTACAO I
           WHERE F.NR_MATRICULA = I.NR_MATRICULA);

-- CONSULTA 1
SELECT F.NM_FUNCIONARIO, F.DT_ADMISSAO, RESULT.QTDEPENDENTES
FROM T_SIP_FUNCIONARIO F,
     (SELECT NR_MATRICULA,
             COUNT(NR_MATRICULA) QTDEPENDENTES
      FROM T_SIP_DEPENDENTE
      GROUP BY NR_MATRICULA) RESULT
WHERE F.NR_MATRICULA = RESULT.NR_MATRICULA;

-- CONSULTA 2
SELECT NR_MATRICULA,
       NM_FUNCIONARIO,
       DT_ADMISSAO,
       VL_SALARIO_MENSAL
FROM T_SIP_FUNCIONARIO
WHERE VL_SALARIO_MENSAL >
      (SELECT MAX(RESULT.MEDIA)
       FROM (SELECT CD_DEPTO,
                    ROUND(AVG(VL_SALARIO_MENSAL), 2) MEDIA
             FROM T_SIP_FUNCIONARIO
             GROUP BY CD_DEPTO) RESULT);

-- CONSULTA 3
SELECT NR_MATRICULA, NM_FUNCIONARIO
FROM T_SIP_FUNCIONARIO
WHERE NR_MATRICULA IN
      (SELECT NR_MATRICULA
       FROM T_SIP_IMPLANTACAO
       WHERE TO_CHAR(DT_ENTRADA, 'YYYY') IN ('2016', '2017'));

-- EXEMPLO – FUNÇÕES LOWER(), UPPER() e INITCAP()
SELECT F.NM_FUNCIONARIO          "COMO ESTÁ GRAVADO",
       LOWER(F.NM_FUNCIONARIO)   "MINUSCULAS (LOWER)",
       UPPER(F.NM_FUNCIONARIO)   "MAIUSCULAS (UPPER)",
       INITCAP(F.NM_FUNCIONARIO) "MAIUSCULA/MINUSCULA (INITCAP)"
FROM T_SIP_FUNCIONARIO F;

-- EXEMPLO – FUNÇÕES ASCII() e CHR()
SELECT ASCII('R'),
       CHR(82)
FROM DUAL;

-- EXEMPLO – FUNÇÃO CONCAT()
SELECT CONCAT(CONCAT(F.NR_MATRICULA, '-'), F.NM_FUNCIONARIO)
FROM T_SIP_FUNCIONARIO F;

-- EXEMPLO – FUNÇÃO INSTR()
-- INSTR -> Retorna a posição da primeira ocorrência de uma string em outra string
-- INSTR(string1, string2, [posição_inicial], [ocorrência])
SELECT F.NM_FUNCIONARIO,
       INSTR(F.NM_FUNCIONARIO, 'A'),
       INSTR(F.NM_FUNCIONARIO, 'JOS'),
       INSTR(F.NM_FUNCIONARIO, 'A', 3),
       INSTR(F.NM_FUNCIONARIO, 'A', 3, 2)
FROM T_SIP_FUNCIONARIO F;

-- EXEMPLO – FUNÇÃO LENGTH ()
SELECT F.NM_FUNCIONARIO,
       LENGTH(F.NM_FUNCIONARIO)
FROM T_SIP_FUNCIONARIO F;

-- EXEMPLO – FUNÇÕES RPAD() e LPAD()
-- RPAD -> Preenche à direita
-- LPAD -> Preenche à esquerda
SELECT F.NM_FUNCIONARIO,
       F.VL_SALARIO,
       RPAD(F.NM_FUNCIONARIO, 60),
       RPAD(F.NM_FUNCIONARIO, 60, '.'),
       LPAD(F.VL_SALARIO, 10, '*')
FROM T_SIP_FUNCIONARIO F;

-- EXEMPLO – FUNÇÕES RTRIM(), LTRIM() E TRIM()
-- RTRIM -> Remove os caracteres à direita
-- LTRIM -> Remove os caracteres à esquerda
SELECT D.NM_DEPTO,
       LTRIM(D.NM_DEPTO),
       TRIM(D.NM_DEPTO)
FROM T_SIP_DEPARTAMENTO D;

-- EXEMPLO – FUNÇÕES RTRIM(), LTRIM() E TRIM()
-- RTRIM -> Remove os caracteres à direita
-- LTRIM -> Remove os caracteres à esquerda
SELECT F.NM_FUNCIONARIO,
       LTRIM(F.NM_FUNCIONARIO, 'A'),
       RTRIM(F.NM_FUNCIONARIO, 'O'),
       TRIM('A' FROM F.NM_FUNCIONARIO)
FROM T_SIP_FUNCIONARIO F;

-- EXEMPLO – FUNÇÕES NVL() e NVL2()
-- NVL1 -> Se o valor for nulo, retorna o valor padrão
-- NVL2 -> Se o valor não for nulo, retorna o valor 1, senão retorna o valor 2
SELECT F.DT_NASCIMENTO,
       NVL(F.DT_NASCIMENTO, '01/01/1900'),
       NVL2(F.DT_NASCIMENTO, SYSDATE, '01/01/1900')
FROM T_SIP_FUNCIONARIO F;

-- EXEMPLO – FUNÇÃO REPLACE()
-- REPLACE -> Substitui uma string por outra
SELECT F.NM_FUNCIONARIO,
       REPLACE(F.NM_FUNCIONARIO, 'A', '*')
FROM T_SIP_FUNCIONARIO F;

-- EXEMPLO – FUNÇÃO SUBSTR()
-- SUBSTR -> Retorna uma parte de uma string
SELECT F.NM_FUNCIONARIO,
       SUBSTR(F.NM_FUNCIONARIO, 3),
       SUBSTR(F.NM_FUNCIONARIO, 3, 5)
FROM T_SIP_FUNCIONARIO F;

-- EXEMPLO – FUNÇÕES NUMÉRICAS
-- ROUND -> Arredonda um número para um número de casas decimais específico ou para o inteiro mais próximo se não for especificado um número de casas decimais. Exemplo: ROUND(123.456, 2) = 123.46
-- TRUNC -> Trunca um número para um número de casas decimais específico. Exemplo: TRUNC(123.456, 2) = 123.45
-- MOD -> Resto da divisão de um número por outro. Exemplo: MOD(10, 3) = 1
-- ABS -> Valor absoluto de um número. Exemplo: ABS(-10) = 10
-- SQRT -> Raiz quadrada de um número. Exemplo: SQRT(16) = 4
SELECT F.VL_SALARIO,
       ROUND(F.VL_SALARIO),
       ROUND(F.VL_SALARIO, 1),
       TRUNC(F.VL_SALARIO),
       TRUNC(F.VL_SALARIO, 1),
       MOD(F.VL_SALARIO, 3),
       ABS(F.VL_SALARIO),
       SQRT(F.VL_SALARIO)
FROM T_SIP_FUNCIONARIO F;

-- EXEMPLO – FUNÇÕES DE CONVERSÃO – TO_CHAR()
-- TO_CHAR -> Converte um valor para um tipo de dado específico. Exemplo: TO_CHAR(123.456, '999.99') = 123.46
-- TO_DATE -> Converte uma string para um valor de data. Exemplo: TO_DATE('01/01/2016', 'DD/MM/YYYY')
-- TO_NUMBER -> Converte uma string para um valor numérico. Exemplo: TO_NUMBER('123.456', '999.999')
SELECT F.VL_SALARIO,
       TO_CHAR(F.VL_SALARIO, 'L9999999.99') "SIMBOLO MOEDA LOCAL",
       TO_CHAR(F.VL_SALARIO, 'C99,999.99')  "SIMBOLO MOEDA ISO",
       TO_CHAR(F.VL_SALARIO, '99,999.99'),
       F.NR_MATRICULA,
       TO_CHAR(F.NR_MATRICULA, '0099999')
FROM T_SIP_FUNCIONARIO F;

-- EXEMPLO – FUNÇÕES DE CONVERSÃO – CAST()
-- CONVERTER VALORES LITERAIS EM TIPOS ESPECÍFICOS
SELECT CAST(12345.67 AS VARCHAR2(10)),
       CAST('29/09/2013' AS DATE),
       CAST(12345.678 AS NUMBER (10, 2))
FROM DUAL;

-- EXEMPLO – FUNÇÕES DE CONVERSÃO – CAST()
-- CONVERTER VALORES DE COLUNA DE UM TIPO PARA OUTRO
SELECT CAST(F.VL_SALARIO AS VARCHAR2(10)),
       CAST(F.VL_SALARIO + 1000 AS NUMBER (8, 2))
FROM T_SIP_FUNCIONARIO F;

-- EXEMPLO – SYSDATE
SELECT SYSDATE
FROM DUAL;

-- EXEMPLO – FUNÇÕES DE DATA – ADD_MONTHS()
SELECT SYSDATE                 "DATA ATUAL",
       ADD_MONTHS(SYSDATE, 1)  "PRÓXIMO MÊS",
       ADD_MONTHS(SYSDATE, -1) "MÊS ANTERIOR"
FROM DUAL;

-- EXEMPLO – FUNÇÕES DE DATA – ADD_MONTHS()
SELECT DT_ADMISSAO,
       ADD_MONTHS(DT_ADMISSAO, 1)
FROM T_SIP_FUNCIONARIO;

-- EXEMPLO – FUNÇÕES DE DATA – LAST_DAY()
SELECT SYSDATE           "DATA ATUAL",
       LAST_DAY(SYSDATE) "DATA COM ÚLTIMO DIA DO MÊS"
FROM DUAL;

-- EXEMPLO – FUNÇÕES DE DATA – LAST_DAY()
SELECT DT_ADMISSAO,
       LAST_DAY(DT_ADMISSAO)
FROM T_SIP_FUNCIONARIO;

-- EXEMPLO – FUNÇÕES DE DATA – MONTHS_BETWEEN()
SELECT DT_ADMISSAO,
       SYSDATE,
       MONTHS_BETWEEN(SYSDATE, DT_ADMISSAO),
       TRUNC(MONTHS_BETWEEN(SYSDATE, DT_ADMISSAO)) || ' MESES'
FROM T_SIP_FUNCIONARIO;

-- EXEMPLO – FUNÇÕES DE DATA – NEXT_DAY()
SELECT SYSDATE,
       NEXT_DAY(SYSDATE, 1) "PRÓXIMO DOMINGO",
       NEXT_DAY(SYSDATE, 2) "PRÓXIMA SEGUNDA",
       NEXT_DAY(SYSDATE, 3) "PRÓXIMA TERÇA",
       NEXT_DAY(SYSDATE, 4) "PRÓXIMA QUARTA",
       NEXT_DAY(SYSDATE, 5) "PRÓXIMA QUINTA",
       NEXT_DAY(SYSDATE, 6) "PRÓXIMA SEXTA",
       NEXT_DAY(SYSDATE, 7) "PRÓXIMO SÁBADO"
FROM DUAL;


-- EXEMPLO – FUNÇÕES DE DATA
SELECT DT_ADMISSAO,
       TO_CHAR(DT_ADMISSAO, 'YYYY')                                                          "ANO CONTRATACAO",
       TO_CHAR(DT_ADMISSAO, 'MM/YYYY')                                                       "MÊS E ANO CONTRATACAO",
       TO_CHAR(DT_ADMISSAO, 'DD/MM')                                                         "DIA E MÊS DA CONTRATACAO",
       TO_CHAR(DT_ADMISSAO, 'DD " de " fmMONTH " de " YYYY', 'NLS_DATE_LANGUAGE=PORTUGUESE') "DATA POR EXTENSO"
FROM T_SIP_FUNCIONARIO;

-- EXEMPLO – FUNÇÕES DE DATA
SELECT DT_ADMISSAO,
       TO_DATE(DT_ADMISSAO, 'DD/MM/YYYY') - 5,
       TO_DATE(SYSDATE, 'DD/MM/YYYY') – TO_DATE(DT_ADMISSAO, 'DD/MM/YYYY')
FROM T_SIP_FUNCIONARIO;

-- EXEMPLO – FUNÇÕES DE DATA
SELECT DT_ADMISSAO,
       TO_DATE(DT_ADMISSAO, 'DD/MM/YYYY HH:MI:SS') + 6 / 24
FROM T_SIP_FUNCIONARIO;
